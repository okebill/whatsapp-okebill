<%- include('partials/header') %>

<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h2 class="mb-0">
            <i class="fas fa-code me-2"></i>
            Dokumentasi API Eglobaltech WA-Gateway
          </h2>
        </div>
        <div class="card-body">
          
          <!-- API Key Auto-Generation -->
          <div class="mb-5">
            <h3 class="text-primary">
              <i class="fas fa-key me-2"></i>
              API Key Auto-Generation
            </h3>
            <div class="alert alert-info">
              <h5><i class="fas fa-info-circle me-2"></i>Fitur Baru: Auto-Generate API Key</h5>
              <p class="mb-2">Sistem sekarang secara otomatis membuat API Key unik setiap kali device WhatsApp terhubung:</p>
              <ul class="mb-0">
                <li><strong>Unik per Device:</strong> Setiap device yang terhubung mendapat API Key yang berbeda</li>
                <li><strong>Format:</strong> <code>wa_[device_hash]_[random_string]</code></li>
                <li><strong>Otomatis:</strong> Dibuat saat QR code berhasil di-scan dan device terhubung</li>
                <li><strong>Keamanan:</strong> API Key lama otomatis diganti dengan yang baru</li>
              </ul>
            </div>
          </div>

          <!-- Send Message Endpoint -->
          <div class="mb-5">
            <h3 class="text-primary">
              <i class="fas fa-paper-plane me-2"></i>
              Send Message (Format Gateway Komersial)
            </h3>
            <div class="alert alert-success">
              <h5><i class="fas fa-check-circle me-2"></i>Endpoint Langsung Tersedia</h5>
              <p class="mb-2">Anda dapat mengirim pesan langsung menggunakan format URL parameter standar gateway komersial:</p>
              <div class="bg-light p-3 rounded mt-3">
                <code class="text-success">
                  GET /send-message?api_key=[API_KEY]&sender=[SENDER]&number=[NUMBER]&message=[MESSAGE]
                </code>
              </div>
            </div>

            <h5 class="mt-4">Parameter:</h5>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Parameter</th>
                  <th>Required</th>
                  <th>Deskripsi</th>
                  <th>Contoh</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>api_key</code></td>
                  <td><span class="badge bg-danger">Required</span></td>
                  <td>API Key yang ter-generate otomatis</td>
                  <td><code>wa_fa50def0_38185e799b82d3fa5e3c7c80f0b9123f</code></td>
                </tr>
                <tr>
                  <td><code>sender</code></td>
                  <td><span class="badge bg-danger">Required</span></td>
                  <td>Nomor pengirim (untuk identifikasi)</td>
                  <td><code>6281280090373</code></td>
                </tr>
                <tr>
                  <td><code>number</code></td>
                  <td><span class="badge bg-danger">Required</span></td>
                  <td>Nomor tujuan atau ID grup</td>
                  <td><code>628123456789</code> atau <code>120363185287561070@g.us</code></td>
                </tr>
                <tr>
                  <td><code>message</code></td>
                  <td><span class="badge bg-danger">Required</span></td>
                  <td>Pesan yang akan dikirim</td>
                  <td><code>Hello World</code></td>
                </tr>
              </tbody>
            </table>

            <h5 class="mt-4">Contoh Penggunaan:</h5>
            <div class="row">
              <div class="col-md-6">
                <h6>Kirim ke Nomor Personal:</h6>
                <div class="bg-light p-3 rounded">
                  <code class="text-primary">
                    http://domain.com/send-message?api_key=wa_fa50def0_38185e799b82d3fa5e3c7c80f0b9123f&sender=6281280090373&number=628123456789&message=Hello%20World
                  </code>
                </div>
              </div>
              <div class="col-md-6">
                <h6>Kirim ke Grup:</h6>
                <div class="bg-light p-3 rounded">
                  <code class="text-primary">
                    http://domain.com/send-message?api_key=wa_fa50def0_38185e799b82d3fa5e3c7c80f0b9123f&sender=6281280090373&number=120363185287561070@g.us&message=TEST%20KIRIM%20PESAN
                  </code>
                </div>
              </div>
            </div>

            <h5 class="mt-4">Response:</h5>
            <div class="row">
              <div class="col-md-6">
                <h6>Success Response:</h6>
                <div class="bg-light p-3 rounded">
                  <pre><code>{
  "success": true,
  "message": "Pesan berhasil dikirim",
  "sender": "6281280090373",
  "to": "628123456789@c.us",
  "timestamp": "2025-01-07T10:30:00.000Z"
}</code></pre>
                </div>
              </div>
              <div class="col-md-6">
                <h6>Error Response:</h6>
                <div class="bg-light p-3 rounded">
                  <pre><code>{
  "success": false,
  "message": "Parameter sender, number, dan message diperlukan"
}</code></pre>
                </div>
              </div>
            </div>

            <div class="alert alert-info mt-4">
              <h6><i class="fas fa-info-circle me-2"></i>Catatan Penting:</h6>
              <ul class="mb-0">
                <li>Pastikan WhatsApp sudah terhubung sebelum mengirim pesan</li>
                <li>Gunakan URL encoding untuk pesan yang mengandung spasi atau karakter khusus</li>
                <li>Format nomor grup harus menggunakan <code>@g.us</code></li>
                <li>Format nomor personal akan otomatis ditambahkan <code>@c.us</code></li>
              </ul>
            </div>
          </div>

          <!-- Authentication -->
          <div class="mb-5">
            <h3 class="text-primary">
              <i class="fas fa-shield-alt me-2"></i>
              Authentication
            </h3>
            <p>Semua request API memerlukan header authentication:</p>
            <div class="bg-light p-3 rounded">
              <code>
                X-API-Key: [YOUR_API_KEY]
              </code>
            </div>
            <div class="mt-3">
              <strong>Cara mendapatkan API Key:</strong>
              <ol>
                <li>Login ke dashboard</li>
                <li>Scan QR Code untuk menghubungkan WhatsApp</li>
                <li>API Key akan otomatis di-generate dan ditampilkan di dashboard</li>
                <li>Copy API Key untuk digunakan dalam aplikasi Anda</li>
              </ol>
            </div>
          </div>

          <div class="alert alert-info">
            <h5><i class="fas fa-info-circle"></i> Informasi API</h5>
            <p class="mb-0">Gunakan endpoint berikut untuk berinteraksi dengan API WhatsApp:</p>
          </div>

          <div class="table-responsive mt-3">
            <table class="table table-bordered">
              <thead class="table-light">
                <tr>
                  <th>Endpoint</th>
                  <th>Method</th>
                  <th>Deskripsi</th>
                  <th>Parameter</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>/api/whatsapp/status</code></td>
                  <td>GET</td>
                  <td>Mendapatkan status koneksi WhatsApp</td>
                  <td>-</td>
                </tr>
                <tr>
                  <td><code>/api/whatsapp/send</code></td>
                  <td>POST</td>
                  <td>Mengirim pesan WhatsApp</td>
                  <td>
                    <ul class="mb-0">
                      <li><code>number</code>: Nomor tujuan (format: 628xxx)</li>
                      <li><code>message</code>: Isi pesan</li>
                    </ul>
                  </td>
                </tr>
                <tr>
                  <td><code>/api/public/send</code></td>
                  <td>POST</td>
                  <td>Mengirim pesan (public API)</td>
                  <td>
                    <ul class="mb-0">
                      <li><code>api_key</code>: API key Anda</li>
                      <li><code>number</code>: Nomor tujuan</li>
                      <li><code>message</code>: Isi pesan</li>
                    </ul>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="mt-4">
            <h5>Contoh Penggunaan</h5>
            <pre class="bg-light p-3 rounded"><code>// Menggunakan fetch
fetch('/api/whatsapp/send', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    number: '628123456789',
    message: 'Hello World!'
  })
});</code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('partials/footer') %> 